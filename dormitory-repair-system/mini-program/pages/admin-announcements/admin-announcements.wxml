<view class="container">
  <view class="header">
    <view class="header-title">å…¬å‘Šç®¡ç†</view>
    <view class="header-subtitle">ç®¡ç†ç³»ç»Ÿå…¬å‘Šä¸é€šçŸ¥</view>
  </view>

  <view class="action-bar">
    <view class="announcement-count">
      <text class="count-text">å…± {{announcements.length}} æ¡å…¬å‘Š</text>
    </view>
    <view class="create-btn" bindtap="onCreate">
      <text class="btn-icon">+</text>
      <text class="btn-text">å‘å¸ƒå…¬å‘Š</text>
    </view>
  </view>

  <scroll-view
    class="content"
    scroll-y="true"
    refresher-enabled="true"
    refresher-triggered="{{refreshing}}"
    bindrefresherrefresh="onPullDownRefresh"
  >
    <view class="announcement-list">
      <view 
        class="announcement-card" 
        wx:for="{{announcements}}" 
        wx:key="announcementId"
        data-id="{{item.announcementId}}"
        bindtap="onViewDetail"
      >
        <view class="card-header">
          <view class="announcement-title">
            <text class="title-badge">å…¬å‘Š</text>
            <text class="title-text">{{item.title}}</text>
          </view>
          <view class="announcement-actions" catchtap="preventClose">
            <view 
              class="action-btn edit" 
              data-id="{{item.announcementId}}"
              catchtap="onEdit"
            >
              <text class="action-icon">âœ</text>
            </view>
            <view 
              class="action-btn delete" 
              data-id="{{item.announcementId}}"
              catchtap="onDelete"
            >
              <text class="action-icon">ğŸ—‘</text>
            </view>
          </view>
        </view>

        <view class="card-body">
          <text class="content-preview">{{item.content}}</text>
        </view>

        <view class="card-footer">
          <view class="date-info">
            <text class="date-icon">ğŸ“…</text>
            <text class="date-text">{{item.createdAtFormatted}}</text>
          </view>
        </view>
      </view>
    </view>

    <view class="empty-state" wx:if="{{announcements.length === 0 && !loading}}">
      <view class="empty-icon">ğŸ“¢</view>
      <text class="empty-text">æš‚æ— å…¬å‘Š</text>
      <text class="empty-subtext">ç‚¹å‡»ä¸Šæ–¹"å‘å¸ƒå…¬å‘Š"æŒ‰é’®æ·»åŠ ç¬¬ä¸€æ¡å…¬å‘Š</text>
    </view>

    <view class="loading-state" wx:if="{{loading}}">
      <view class="loading-spinner"></view>
      <text class="loading-text">åŠ è½½ä¸­...</text>
    </view>
  </scroll-view>
</view>

<view class="modal-overlay" wx:if="{{showModal}}" bindtap="onCloseModal">
  <view class="modal-container" catchtap="preventClose">
    <view class="modal-header">
      <text class="modal-title">{{modalType === 'create' ? 'å‘å¸ƒå…¬å‘Š' : 'ç¼–è¾‘å…¬å‘Š'}}</text>
      <view class="close-btn" bindtap="onCloseModal">âœ•</view>
    </view>

    <view class="modal-body">
      <view class="form-group">
        <text class="form-label">å…¬å‘Šæ ‡é¢˜</text>
        <input 
          class="form-input" 
          placeholder="è¯·è¾“å…¥å…¬å‘Šæ ‡é¢˜"
          value="{{formData.title}}"
          bindinput="onTitleInput"
          maxlength="100"
        />
      </view>

      <view class="form-group">
        <text class="form-label">å…¬å‘Šå†…å®¹</text>
        <textarea 
          class="form-textarea" 
          placeholder="è¯·è¾“å…¥å…¬å‘Šå†…å®¹"
          value="{{formData.content}}"
          bindinput="onContentInput"
          maxlength="500"
          auto-height
        />
        <view class="char-count">
          <text>{{formData.content.length}}/500</text>
        </view>
      </view>
    </view>

    <view class="modal-footer">
      <view class="btn-cancel" bindtap="onCloseModal">å–æ¶ˆ</view>
      <view class="btn-submit {{submitting ? 'disabled' : ''}}" bindtap="onSubmit">
        <text wx:if="{{!submitting}}">{{modalType === 'create' ? 'å‘å¸ƒ' : 'ä¿å­˜'}}</text>
        <view wx:if="{{submitting}}" class="btn-spinner"></view>
      </view>
    </view>
  </view>
</view>