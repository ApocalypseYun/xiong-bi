<view class="register-container">
  <view class="header">
    <view class="back-btn" bindtap="goBack"><text>â†</text></view>
    <view class="header-title">æ³¨å†Œè´¦å·</view>
  </view>

  <view class="register-card">
    <view class="role-section">
      <view class="section-title">é€‰æ‹©è§’è‰²</view>
      <view class="role-tabs">
        <view class="role-tab {{role === 'student' ? 'active' : ''}}" bindtap="switchRole" data-role="student">
          <text class="role-tab-icon">ğŸ‘¨â€ğŸ“</text>
          <text>å­¦ç”Ÿ</text>
        </view>
        <view class="role-tab {{role === 'admin' ? 'active' : ''}}" bindtap="switchRole" data-role="admin">
          <text class="role-tab-icon">ğŸ‘¨â€ğŸ’¼</text>
          <text>ç®¡ç†å‘˜</text>
        </view>
      </view>
    </view>

    <view class="form-section">
      <view class="input-group">
        <text class="input-label">ç”¨æˆ·å<text class="required">*</text></text>
        <view class="input-wrapper {{errors.username ? 'error' : ''}}">
          <text class="input-icon">ğŸ‘¤</text>
          <input 
            class="input-field" 
            placeholder="3-20ä½å­—æ¯æ•°å­—ä¸‹åˆ’çº¿" 
            value="{{username}}"
            data-field="username"
            bindinput="onInput"
          />
        </view>
        <text class="error-tip" wx:if="{{errors.username}}">{{errors.username}}</text>
      </view>

      <view class="input-group">
        <text class="input-label">å¯†ç <text class="required">*</text></text>
        <view class="input-wrapper {{errors.password ? 'error' : ''}}">
          <text class="input-icon">ğŸ”’</text>
          <input 
            class="input-field" 
            placeholder="è‡³å°‘6ä½å¯†ç " 
            password="{{!showPassword}}"
            value="{{password}}"
            data-field="password"
            bindinput="onInput"
          />
          <view class="password-toggle" bindtap="togglePassword" data-field="showPassword">
            <text>{{showPassword ? 'ğŸ™ˆ' : 'ğŸ‘ï¸'}}</text>
          </view>
        </view>
        <text class="error-tip" wx:if="{{errors.password}}">{{errors.password}}</text>
      </view>

      <view class="input-group">
        <text class="input-label">ç¡®è®¤å¯†ç <text class="required">*</text></text>
        <view class="input-wrapper {{errors.confirmPassword ? 'error' : ''}}">
          <text class="input-icon">ğŸ”</text>
          <input 
            class="input-field" 
            placeholder="å†æ¬¡è¾“å…¥å¯†ç " 
            password="{{!showConfirmPassword}}"
            value="{{confirmPassword}}"
            data-field="confirmPassword"
            bindinput="onInput"
          />
          <view class="password-toggle" bindtap="togglePassword" data-field="showConfirmPassword">
            <text>{{showConfirmPassword ? 'ğŸ™ˆ' : 'ğŸ‘ï¸'}}</text>
          </view>
        </view>
        <text class="error-tip" wx:if="{{errors.confirmPassword}}">{{errors.confirmPassword}}</text>
      </view>

      <block wx:if="{{role === 'student'}}">
        <view class="input-group">
          <text class="input-label">çœŸå®å§“å</text>
          <view class="input-wrapper">
            <text class="input-icon">âœï¸</text>
            <input 
              class="input-field" 
              placeholder="è¯·è¾“å…¥çœŸå®å§“å" 
              value="{{realName}}"
              data-field="realName"
              bindinput="onInput"
            />
          </view>
        </view>

        <view class="input-group">
          <text class="input-label">æ‰‹æœºå·<text class="required">*</text></text>
          <view class="input-wrapper {{errors.phone ? 'error' : ''}}">
            <text class="input-icon">ğŸ“±</text>
            <input 
              class="input-field" 
              placeholder="è¯·è¾“å…¥æ‰‹æœºå·" 
              type="number"
              maxlength="11"
              value="{{phone}}"
              data-field="phone"
              bindinput="onInput"
            />
          </view>
          <text class="error-tip" wx:if="{{errors.phone}}">{{errors.phone}}</text>
        </view>

        <view class="form-row">
          <view class="input-group">
            <text class="input-label">æ¥¼æ ‹<text class="required">*</text></text>
            <view class="input-wrapper {{errors.building ? 'error' : ''}}">
              <text class="input-icon">ğŸ¢</text>
              <input 
                class="input-field" 
                placeholder="å¦‚:Aæ ‹" 
                value="{{building}}"
                data-field="building"
                bindinput="onInput"
              />
            </view>
            <text class="error-tip" wx:if="{{errors.building}}">{{errors.building}}</text>
          </view>

          <view class="input-group">
            <text class="input-label">æˆ¿é—´å·<text class="required">*</text></text>
            <view class="input-wrapper {{errors.roomNumber ? 'error' : ''}}">
              <text class="input-icon">ğŸšª</text>
              <input 
                class="input-field" 
                placeholder="å¦‚:101" 
                value="{{roomNumber}}"
                data-field="roomNumber"
                bindinput="onInput"
              />
            </view>
            <text class="error-tip" wx:if="{{errors.roomNumber}}">{{errors.roomNumber}}</text>
          </view>
        </view>
      </block>
    </view>

    <button class="register-btn" bindtap="handleRegister" disabled="{{isLoading}}">
      {{isLoading ? 'æ³¨å†Œä¸­...' : 'ç«‹å³æ³¨å†Œ'}}
    </button>

    <view class="bottom-tip">
      <text class="tip-text">å·²æœ‰è´¦å·ï¼Ÿ<text class="tip-link" bindtap="goBack">ç«‹å³ç™»å½•</text></text>
    </view>
  </view>
</view>
